```html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Business Card Editor</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <style>
    body {
      margin: 0;
      background-color: #f3f4f6;
      font-family: 'Inter', 'Roboto', sans-serif;
      min-height: 100vh;
    }

    .header {
      background: linear-gradient(to right, #1e3a8a, #3b82f6);
      color: white;
      padding: 1rem;
      text-align: center;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 30;
      transition: transform 0.3s ease;
    }

    .header.hidden {
      transform: translateY(-100%);
    }

    .container {
      display: flex;
      gap: 1.5rem;
      padding: 1.5rem;
      max-width: 1400px;
      margin: 0 auto;
      padding-top: 80px;
    }

    .column-1, .column-3 {
      width: 250px;
      background: #fff;
      padding: 1.5rem;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      border: 1px solid #e5e7eb;
    }

    .column-2 {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1rem;
    }

    .card-mockup {
      width: 350px;
      height: 200px;
      background-color: #fff;
      border-radius: 8px;
      border: 1px solid #e5e7eb;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      overflow: hidden;
      position: relative;
    }

    .card-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 8px;
      position: absolute;
      top: 0;
      left: 0;
      z-index: 1;
    }

    .text-element, .logo, .qr-element, .social-element {
      position: absolute;
      z-index: 2;
      cursor: move;
      user-select: none;
    }

    .text-element {
      min-width: 50px;
      padding: 4px;
      color: #fff;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
      font-size: 14px;
    }

    .logo, .qr-element, .social-element img {
      max-width: 50px;
      max-height: 50px;
    }

    .resize-handle {
      position: absolute;
      bottom: -4px;
      right: -4px;
      width: 8px;
      height: 8px;
      background-color: #3b82f6;
      border-radius: 50%;
      cursor: se-resize;
      z-index: 3;
    }

    .selected {
      border: 2px solid #3b82f6;
      border-radius: 4px;
    }

    .control-section {
      border: 1px solid #e5e7eb;
      padding: 1rem;
      border-radius: 6px;
      background-color: #fff;
      margin-bottom: 1rem;
    }

    .text-controls {
      display: none;
      margin-top: 1rem;
      padding: 1rem;
      background: #f9fafb;
      border-radius: 6px;
      border: 1px solid #e5e7eb;
      width: 100%;
      max-width: 350px;
    }

    .text-controls.active {
      display: block;
    }

    .grid-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: repeating-linear-gradient(
        0deg,
        transparent,
        transparent 19px,
        rgba(0, 0, 0, 0.1) 20px
      ),
      repeating-linear-gradient(
        90deg,
        transparent,
        transparent 19px,
        rgba(0, 0, 0, 0.1) 20px
      );
      z-index: 0;
      pointer-events: none;
      opacity: 0.6;
    }

    .print-guides {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 3;
      pointer-events: none;
    }

    .trim-line {
      border: 2px solid #ef4444;
      width: 100%;
      height: 100%;
      border-radius: 8px;
    }

    .safe-area {
      position: absolute;
      top: 8px;
      left: 8px;
      width: calc(100% - 16px);
      height: calc(100% - 16px);
      border: 2px dashed #22c55e;
      border-radius: 4px;
    }

    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.6);
      z-index: 20;
      justify-content: center;
      align-items: center;
    }

    .modal-content {
      background-color: #fff;
      padding: 1.5rem;
      border-radius: 8px;
      max-width: 90%;
      max-height: 80vh;
      overflow-y: auto;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }

    .image-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      gap: 0.75rem;
    }

    .image-grid img {
      width: 100%;
      height: 80px;
      object-fit: cover;
      border-radius: 6px;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .image-grid img:hover {
      transform: scale(1.05);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    }

    @media (max-width: 1024px) {
      .container {
        flex-direction: column;
        align-items: center;
      }
      .column-1, .column-3 {
        width: 100%;
        max-width: 350px;
      }
      .text-controls {
        max-width: 100%;
      }
    }
  </style>
</head>
<body>
  <header class="header" id="header">
    <h1 class="text-2xl font-semibold">Business Card Editor</h1>
  </header>
  <div class="container">
    <!-- Column 1 -->
    <div class="column-1">
      <div class="control-section">
        <h3 class="text-sm font-medium text-gray-700 mb-2">Background</h3>
        <input type="file" id="backgroundInput" accept="image/*" class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-medium file:bg-blue-50 file:text-blue-600 hover:file:bg-blue-100">
        <button id="onlineBackgroundBtn" class="mt-2 w-full py-2 px-4 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors">Choose Template</button>
      </div>
      <div class="control-section">
        <h3 class="text-sm font-medium text-gray-700 mb-2">Add Elements</h3>
        <input type="file" id="logoInput" accept="image/*" class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-medium file:bg-blue-50 file:text-blue-600 hover:file:bg-blue-100">
        <button id="addTextBtn" class="mt-2 w-full py-2 px-4 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors">Add Text</button>
        <select id="socialSelect" class="mt-2 block w-full py-2 px-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
          <option value="facebook">Facebook</option>
          <option value="tiktok">TikTok</option>
          <option value="phone">Phone</option>
        </select>
        <input type="text" id="socialTextInput" placeholder="Enter social media handle" class="mt-2 block w-full py-2 px-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
        <button id="addSocialBtn" class="mt-2 w-full py-2 px-4 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors">Add Social Media</button>
      </div>
    </div>

    <!-- Column 2 -->
    <div class="column-2">
      <div class="card-mockup" id="cardMockup">
        <div class="grid-overlay" id="gridOverlay" style="display: none;"></div>
        <div class="print-guides" id="printGuides" style="display: none;">
          <div class="trim-line"></div>
          <div class="safe-area"></div>
        </div>
        <img src="https://static.vecteezy.com/system/resources/previews/024/140/681/non_2x/abstract-background-illustration-green-background-illustration-abstract-green-background-for-wallpaper-display-landing-page-banner-or-layout-simple-design-graphic-for-display-free-vector.jpg" alt="Business Card Mockup" class="card-image" id="cardImage">
      </div>
      <div class="text-controls" id="textControls">
        <h3 class="text-sm font-medium text-gray-700 mb-2">Text Styling</h3>
        <label class="block text-sm font-medium text-gray-600">Font Family</label>
        <select id="fontFamily" class="mt-1 block w-full py-2 px-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
          <option value="Arial, sans-serif">Arial</option>
          <option value="'Roboto', sans-serif">Roboto</option>
          <option value="'Times New Roman', Times, serif">Times New Roman</option>
          <option value="'Georgia', serif">Georgia</option>
          <option value="'Helvetica', sans-serif">Helvetica</option>
          <option value="'Verdana', sans-serif">Verdana</option>
          <option value="'Courier New', Courier, monospace">Courier New</option>
          <option value="'Open Sans', sans-serif">Open Sans</option>
        </select>
        <label class="block text-sm font-medium text-gray-600 mt-2">Text Color</label>
        <input type="color" id="textColor" value="#ffffff" class="mt-1 w-full h-8 rounded-md border border-gray-300">
        <label class="block text-sm font-medium text-gray-600 mt-2">Font Size</label>
        <input type="range" id="fontSize" min="8" max="48" value="14" class="mt-1 w-full">
        <span id="fontSizeValue" class="text-sm text-gray-500">14px</span>
        <label class="block text-sm font-medium text-gray-600 mt-2">Letter Spacing</label>
        <input type="range" id="letterSpacing" min="-2" max="5" step="0.1" value="0" class="mt-1 w-full">
        <span id="letterSpacingValue" class="text-sm text-gray-500">0px</span>
        <label class="block text-sm font-medium text-gray-600 mt-2">Line Height</label>
        <input type="range" id="lineHeight" min="0.8" max="2" step="0.1" value="1" class="mt-1 w-full">
        <span id="lineHeightValue" class="text-sm text-gray-500">1</span>
        <label class="block text-sm font-medium text-gray-600 mt-2">Text Rotation</label>
        <input type="range" id="textRotation" min="-180" max="180" value="0" class="mt-1 w-full">
        <span id="textRotationValue" class="text-sm text-gray-500">0°</span>
        <label class="block text-sm font-medium text-gray-600 mt-2">Opacity</label>
        <input type="range" id="textOpacity" min="0" max="1" step="0.01" value="1" class="mt-1 w-full">
        <span id="textOpacityValue" class="text-sm text-gray-500">1</span>
        <label class="block text-sm font-medium text-gray-600 mt-2">Border Width</label>
        <input type="range" id="borderWidth" min="0" max="5" value="0" class="mt-1 w-full">
        <span id="borderWidthValue" class="text-sm text-gray-500">0px</span>
        <label class="block text-sm font-medium text-gray-600 mt-2">Border Color</label>
        <input type="color" id="borderColor" value="#000000" class="mt-1 w-full h-8 rounded-md border border-gray-300">
        <label class="block text-sm font-medium text-gray-600 mt-2">Shadow X Offset</label>
        <input type="range" id="shadowX" min="-10" max="10" value="0" class="mt-1 w-full">
        <span id="shadowXValue" class="text-sm text-gray-500">0px</span>
        <label class="block text-sm font-medium text-gray-600 mt-2">Shadow Y Offset</label>
        <input type="range" id="shadowY" min="-10" max="10" value="0" class="mt-1 w-full">
        <span id="shadowYValue" class="text-sm text-gray-500">0px</span>
        <label class="block text-sm font-medium text-gray-600 mt-2">Glow Thickness</label>
        <input type="range" id="glowThickness" min="0" max="10" value="0" class="mt-1 w-full">
        <span id="glowThicknessValue" class="text-sm text-gray-500">0px</span>
        <label class="block text-sm font-medium text-gray-600 mt-2">Glow Color</label>
        <input type="color" id="glowColor" value="#ffffff" class="mt-1 w-full h-8 rounded-md border border-gray-300">
        <label class="block text-sm font-medium text-gray-600 mt-2">Text Alignment</label>
        <select id="textAlignment" class="mt-1 block w-full py-2 px-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
          <option value="left">Left</option>
          <option value="center">Center</option>
          <option value="right">Right</option>
          <option value="justify">Justify</option>
        </select>
        <div class="mt-2 flex gap-2">
          <button id="boldBtn" class="py-1 px-3 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors">Bold</button>
          <button id="italicBtn" class="py-1 px-3 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors">Italic</button>
          <button id="underlineBtn" class="py-1 px-3 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors">Underline</button>
        </div>
      </div>
    </div>

    <!-- Column 3 -->
    <div class="column-3">
      <div class="control-section">
        <h3 class="text-sm font-medium text-gray-700 mb-2">Export & Settings</h3>
        <button id="downloadBtn" class="w-full py-2 px-4 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors">Export as PNG</button>
        <button id="saveSettingsBtn" class="mt-2 w-full py-2 px-4 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors">Save Settings</button>
        <input type="file" id="uploadSettingsBtn" accept=".json" class="mt-2 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-medium file:bg-blue-50 file:text-blue-600 hover:file:bg-blue-100">
      </div>
    </div>
  </div>

  <div class="modal" id="backgroundModal">
    <div class="modal-content">
      <h2 class="text-lg font-semibold text-gray-800 mb-4">Select Template Background</h2>
      <div class="image-grid" id="imageGrid"></div>
      <button id="closeModal" class="mt-4 w-full py-2 px-4 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors">Close</button>
    </div>
  </div>

  <script>
    const backgroundImages = [
      'https://png.pngtree.com/thumb_back/fh260/back_pic/04/16/74/5158259f411ac49.jpg',
      'https://png.pngtree.com/thumb_back/fh260/back_our/20190623/ourmid/pngtree-blue-minimalistic-geometric-business-card-background-image_239792.jpg',
      // ... (other background images as in the original code)
    ];

    const cardMockup = document.getElementById('cardMockup');
    const cardImage = document.getElementById('cardImage');
    const backgroundInput = document.getElementById('backgroundInput');
    const logoInput = document.getElementById('logoInput');
    const addTextBtn = document.getElementById('addTextBtn');
    const socialSelect = document.getElementById('socialSelect');
    const socialTextInput = document.getElementById('socialTextInput');
    const addSocialBtn = document.getElementById('addSocialBtn');
    const textControls = document.getElementById('textControls');
    const fontFamily = document.getElementById('fontFamily');
    const textColor = document.getElementById('textColor');
    const fontSize = document.getElementById('fontSize');
    const fontSizeValue = document.getElementById('fontSizeValue');
    const letterSpacing = document.getElementById('letterSpacing');
    const letterSpacingValue = document.getElementById('letterSpacingValue');
    const lineHeight = document.getElementById('lineHeight');
    const lineHeightValue = document.getElementById('lineHeightValue');
    const textRotation = document.getElementById('textRotation');
    const textRotationValue = document.getElementById('textRotationValue');
    const textOpacity = document.getElementById('textOpacity');
    const textOpacityValue = document.getElementById('textOpacityValue');
    const borderWidth = document.getElementById('borderWidth');
    const borderWidthValue = document.getElementById('borderWidthValue');
    const borderColor = document.getElementById('borderColor');
    const shadowX = document.getElementById('shadowX');
    const shadowXValue = document.getElementById('shadowXValue');
    const shadowY = document.getElementById('shadowY');
    const shadowYValue = document.getElementById('shadowYValue');
    const glowThickness = document.getElementById('glowThickness');
    const glowThicknessValue = document.getElementById('glowThicknessValue');
    const glowColor = document.getElementById('glowColor');
    const textAlignment = document.getElementById('textAlignment');
    const boldBtn = document.getElementById('boldBtn');
    const italicBtn = document.getElementById('italicBtn');
    const underlineBtn = document.getElementById('underlineBtn');
    const downloadBtn = document.getElementById('downloadBtn');
    const saveSettingsBtn = document.getElementById('saveSettingsBtn');
    const uploadSettingsBtn = document.getElementById('uploadSettingsBtn');
    const onlineBackgroundBtn = document.getElementById('onlineBackgroundBtn');
    const backgroundModal = document.getElementById('backgroundModal');
    const imageGrid = document.getElementById('imageGrid');
    const closeModal = document.getElementById('closeModal');
    const header = document.getElementById('header');

    let currentSelected = null;
    let elementId = 0;

    // Social media icons
    const socialIcons = {
      facebook: 'https://img.icons8.com/color/48/000000/facebook-new.png',
      tiktok: 'https://img.icons8.com/color/48/000000/tiktok.png',
      phone: 'https://img.icons8.com/color/48/000000/phone.png'
    };

    // Hide header on scroll
    let lastScrollY = 0;
    window.addEventListener('scroll', () => {
      const currentScrollY = window.scrollY;
      if (currentScrollY > lastScrollY && currentScrollY > 50) {
        header.classList.add('hidden');
      } else {
        header.classList.remove('hidden');
      }
      lastScrollY = currentScrollY;
    });

    // Populate image grid
    function populateImageGrid() {
      imageGrid.innerHTML = '';
      backgroundImages.forEach((url, index) => {
        const img = document.createElement('img');
        img.src = url;
        img.alt = `Background ${index + 1}`;
        img.addEventListener('click', () => {
          cardImage.src = url;
          backgroundModal.style.display = 'none';
        });
        imageGrid.appendChild(img);
      });
    }

    onlineBackgroundBtn.addEventListener('click', () => {
      populateImageGrid();
      backgroundModal.style.display = 'flex';
    });

    closeModal.addEventListener('click', () => {
      backgroundModal.style.display = 'none';
    });

    backgroundModal.addEventListener('click', (e) => {
      if (e.target === backgroundModal) {
        backgroundModal.style.display = 'none';
      }
    });

    // Drag functionality
    function makeDraggable(element) {
      let isDragging = false;
      let currentX, currentY, initialX, initialY;

      element.addEventListener('mousedown', startDragging);
      element.addEventListener('touchstart', startDragging, { passive: false });

      function startDragging(e) {
        e.preventDefault();
        isDragging = true;
        const clientX = e.type === 'touchstart' ? e.touches[0].clientX : e.clientX;
        const clientY = e.type === 'touchstart' ? e.touches[0].clientY : e.clientY;
        initialX = clientX - (parseFloat(element.style.left) || 0);
        initialY = clientY - (parseFloat(element.style.top) || 0);
        document.addEventListener('mousemove', drag);
        document.addEventListener('touchmove', drag, { passive: false });
        document.addEventListener('mouseup', stopDragging);
        document.addEventListener('touchend', stopDragging);
      }

      function drag(e) {
        if (!isDragging) return;
        e.preventDefault();
        const clientX = e.type === 'touchmove' ? e.touches[0].clientX : e.clientX;
        const clientY = e.type === 'touchmove' ? e.touches[0].clientY : e.clientY;
        const rect = cardMockup.getBoundingClientRect();
        let x = clientX - initialX;
        let y = clientY - initialY;

        x = Math.max(0, Math.min(x, rect.width - element.offsetWidth));
        y = Math.max(0, Math.min(y, rect.height - element.offsetHeight));

        element.style.left = `${x}px`;
        element.style.top = `${y}px`;
        element.style.bottom = 'auto';
        element.style.right = 'auto';
      }

      function stopDragging() {
        isDragging = false;
        document.removeEventListener('mousemove', drag);
        document.removeEventListener('touchmove', drag);
        document.removeEventListener('mouseup', stopDragging);
        document.removeEventListener('touchend', stopDragging);
      }
    }

    // Resize functionality
    function makeResizable(element, handle, isImage = false) {
      let isResizing = false;
      let startWidth, startHeight, startX, startY;

      handle.addEventListener('mousedown', startResizing);
      handle.addEventListener('touchstart', startResizing, { passive: false });

      function startResizing(e) {
        e.preventDefault();
        isResizing = true;
        startWidth = element.offsetWidth;
        startHeight = element.offsetHeight;
        startX = e.type === 'touchstart' ? e.touches[0].clientX : e.clientX;
        startY = e.type === 'touchstart' ? e.touches[0].clientY : e.clientY;
        document.addEventListener('mousemove', resize);
        document.addEventListener('touchmove', resize, { passive: false });
        document.addEventListener('mouseup', stopResizing);
        document.addEventListener('touchend', stopResizing);
      }

      function resize(e) {
        if (!isResizing) return;
        e.preventDefault();
        const clientX = e.type === 'touchmove' ? e.touches[0].clientX : e.clientX;
        const clientY = e.type === 'touchmove' ? e.touches[0].clientY : e.clientY;
        const dx = clientX - startX;
        const dy = clientY - startY;
        if (isImage) {
          element.style.maxWidth = `${Math.max(20, startWidth + dx)}px`;
          element.style.maxHeight = `${Math.max(20, startHeight + dy)}px`;
        } else {
          element.style.width = `${Math.max(50, startWidth + dx)}px`;
          element.style.fontSize = `${Math.max(8, parseInt(element.style.fontSize) + dy / 10)}px`;
        }
      }

      function stopResizing() {
        isResizing = false;
        document.removeEventListener('mousemove', resize);
        document.removeEventListener('touchmove', resize);
        document.removeEventListener('mouseup', stopResizing);
        document.removeEventListener('touchend', stopResizing);
      }
    }

    // Pinch-to-resize
    function addPinchResize(element, isImage = false) {
      let initialDistance = 0;
      let startWidth = 0;

      element.addEventListener('touchstart', (e) => {
        if (e.touches.length === 2) {
          e.preventDefault();
          const touch1 = e.touches[0];
          const touch2 = e.touches[1];
          initialDistance = Math.hypot(touch1.clientX - touch2.clientX, touch1.clientY - touch2.clientY);
          startWidth = element.offsetWidth;
        }
      });

      element.addEventListener('touchmove', (e) => {
        if (e.touches.length === 2) {
          e.preventDefault();
          const touch1 = e.touches[0];
          const touch2 = e.touches[1];
          const distance = Math.hypot(touch1.clientX - touch2.clientX, touch1.clientY - touch2.clientY);
          const scale = distance / initialDistance;
          if (isImage) {
            element.style.maxWidth = `${Math.max(20, startWidth * scale)}px`;
            element.style.maxHeight = `${Math.max(20, startWidth * scale)}px`;
          } else {
            element.style.width = `${Math.max(50, startWidth * scale)}px`;
          }
        }
      });
    }

    // Add selection and text editing
    function addSelection(element, handle = null) {
      element.addEventListener('click', (e) => {
        e.stopPropagation();
        if (currentSelected) {
          currentSelected.classList.remove('selected');
          if (currentSelected.handle) currentSelected.handle.style.display = 'none';
        }
        currentSelected = element;
        currentSelected.classList.add('selected');
        currentSelected.handle = handle;
        if (handle) handle.style.display = 'block';
        textControls.classList.toggle('active', element.classList.contains('text-element') || element.classList.contains('social-element'));
        loadStylesToControls();
      });

      // Enable text editing on double-click
      if (element.classList.contains('text-element') || element.classList.contains('social-element')) {
        const textNode = element.querySelector('.text-content') || element;
        textNode.addEventListener('dblclick', () => {
          textNode.contentEditable = true;
          textNode.focus();
        });
        textNode.addEventListener('blur', () => {
          textNode.contentEditable = false;
          if (textNode.innerText.trim() === '') {
            textNode.innerText = 'New Text';
          }
        });
      }
    }

    // Load styles to controls
    function loadStylesToControls() {
      if (!currentSelected || (!currentSelected.classList.contains('text-element') && !currentSelected.classList.contains('social-element'))) {
        textControls.classList.remove('active');
        return;
      }
      const target = currentSelected.classList.contains('social-element') ? currentSelected.querySelector('.text-content') : currentSelected;
      fontFamily.value = target.style.fontFamily || 'Arial, sans-serif';
      textColor.value = rgbToHex(target.style.color) || '#ffffff';
      fontSize.value = parseInt(target.style.fontSize) || 14;
      fontSizeValue.textContent = `${fontSize.value}px`;
      letterSpacing.value = parseFloat(target.style.letterSpacing) || 0;
      letterSpacingValue.textContent = `${letterSpacing.value}px`;
      lineHeight.value = parseFloat(target.style.lineHeight) || 1;
      lineHeightValue.textContent = `${lineHeight.value}`;
      textRotation.value = parseFloat(target.style.transform?.match(/rotate\(([^)]+)\)/)?.[1]) || 0;
      textRotationValue.textContent = `${textRotation.value}°`;
      textOpacity.value = parseFloat(target.style.opacity) || 1;
      textOpacityValue.textContent = `${textOpacity.value}`;
      borderWidth.value = parseInt(target.style.borderWidth) || 0;
      borderWidthValue.textContent = `${borderWidth.value}px`;
      borderColor.value = rgbToHex(target.style.borderColor) || '#000000';
      shadowX.value = parseInt(target.style.textShadow?.split(' ')[0]) || 0;
      shadowXValue.textContent = `${shadowX.value}px`;
      shadowY.value = parseInt(target.style.textShadow?.split(' ')[1]) || 0;
      shadowYValue.textContent = `${shadowY.value}px`;
      glowThickness.value = parseInt(target.style.textShadow?.split(' ')[2]) || 0;
      glowThicknessValue.textContent = `${glowThickness.value}px`;
      glowColor.value = rgbToHex(target.style.textShadow?.split(' ')[3]) || '#ffffff';
      textAlignment.value = target.style.textAlign || 'left';
      boldBtn.classList.toggle('bg-blue-300', target.style.fontWeight === 'bold');
      italicBtn.classList.toggle('bg-blue-300', target.style.fontStyle === 'italic');
      underlineBtn.classList.toggle('bg-blue-300', target.style.textDecoration === 'underline');
    }

    // RGB to Hex
    function rgbToHex(rgb) {
      if (!rgb || rgb === 'none') return '#ffffff';
      const match = rgb.match(/\d+/g);
      if (!match) return '#ffffff';
      const [r, g, b] = match;
      return '#' + ((1 << 24) + (parseInt(r) << 16) + (parseInt(g) << 8) + parseInt(b)).toString(16).slice(1);
    }

    // Apply styles
    function applyStyles() {
      if (!currentSelected || (!currentSelected.classList.contains('text-element') && !currentSelected.classList.contains('social-element'))) return;
      const target = currentSelected.classList.contains('social-element') ? currentSelected.querySelector('.text-content') : currentSelected;
      target.style.fontFamily = fontFamily.value;
      target.style.color = textColor.value;
      target.style.fontSize = `${fontSize.value}px`;
      target.style.letterSpacing = `${letterSpacing.value}px`;
      target.style.lineHeight = `${lineHeight.value}`;
      target.style.transform = `rotate(${textRotation.value}deg)`;
      target.style.opacity = textOpacity.value;
      target.style.borderWidth = `${borderWidth.value}px`;
      target.style.borderStyle = borderWidth.value > 0 ? 'solid' : 'none';
      target.style.borderColor = borderColor.value;
      target.style.textShadow = glowThickness.value > 0 ? `${shadowX.value}px ${shadowY.value}px ${glowThickness.value}px ${glowColor.value}` : 'none';
      target.style.textAlign = textAlignment.value;
      target.style.fontWeight = boldBtn.classList.contains('bg-blue-300') ? 'bold' : 'normal';
      target.style.fontStyle = italicBtn.classList.contains('bg-blue-300') ? 'italic' : 'normal';
      target.style.textDecoration = underlineBtn.classList.contains('bg-blue-300') ? 'underline' : 'none';
    }

    // Create text element
    addTextBtn.addEventListener('click', () => {
      const textElement = document.createElement('div');
      textElement.className = 'text-element';
      textElement.id = `element-${elementId++}`;
      textElement.contentEditable = false;
      textElement.innerText = 'New Text';
      textElement.style.left = '50px';
      textElement.style.top = '50px';
      textElement.style.color = '#fff';
      textElement.style.fontSize = '14px';
      textElement.style.zIndex = '2';
      const resizeHandle = document.createElement('div');
      resizeHandle.className = 'resize-handle';
      textElement.appendChild(resizeHandle);
      cardMockup.appendChild(textElement);
      makeDraggable(textElement);
      makeResizable(textElement, resizeHandle);
      addPinchResize(textElement);
      addSelection(textElement, resizeHandle);
    });

    // Add logo
    logoInput.addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = () => {
          const logo = document.createElement('img');
          logo.className = 'logo';
          logo.id = `element-${elementId++}`;
          logo.src = reader.result;
          logo.style.left = '10px';
          logo.style.top = '10px';
          logo.style.zIndex = '2';
          logo.style.display = 'block';
          const resizeHandle = document.createElement('div');
          resizeHandle.className = 'resize-handle';
          cardMockup.appendChild(logo);
          cardMockup.appendChild(resizeHandle);
          resizeHandle.style.display = 'block';
          makeDraggable(logo);
          makeResizable(logo, resizeHandle, true);
          addPinchResize(logo, true);
          addSelection(logo, resizeHandle);
        };
        reader.readAsDataURL(file);
      }
    });

    // Add social media element
    addSocialBtn.addEventListener('click', () => {
      const type = socialSelect.value;
      const text = socialTextInput.value.trim();
      if (!text) return;
      const socialElement = document.createElement('div');
      socialElement.className = 'social-element';
      socialElement.id = `element-${elementId++}`;
      socialElement.style.left = '10px';
      socialElement.style.top = '10px';
      socialElement.style.zIndex = '2';
      socialElement.style.display = 'flex';
      socialElement.style.alignItems = 'center';
      socialElement.style.gap = '8px';
      const img = document.createElement('img');
      img.src = socialIcons[type];
      img.style.width = '30px';
      img.style.height = '30px';
      const textNode = document.createElement('span');
      textNode.className = 'text-content';
      textNode.innerText = text;
      textNode.style.color = '#fff';
      textNode.style.fontSize = '14px';
      socialElement.appendChild(img);
      socialElement.appendChild(textNode);
      const resizeHandle = document.createElement('div');
      resizeHandle.className = 'resize-handle';
      socialElement.appendChild(resizeHandle);
      cardMockup.appendChild(socialElement);
      makeDraggable(socialElement);
      makeResizable(socialElement, resizeHandle);
      addPinchResize(socialElement);
      addSelection(socialElement, resizeHandle);
      socialTextInput.value = '';
    });

    // Background upload
    backgroundInput.addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = () => {
          cardImage.src = reader.result;
        };
        reader.readAsDataURL(file);
      }
    });

    // Style listeners
    fontFamily.addEventListener('change', applyStyles);
    textColor.addEventListener('input', applyStyles);
    fontSize.addEventListener('input', () => {
      fontSizeValue.textContent = `${fontSize.value}px`;
      applyStyles();
    });
    letterSpacing.addEventListener('input', () => {
      letterSpacingValue.textContent = `${letterSpacing.value}px`;
      applyStyles();
    });
    lineHeight.addEventListener('input', () => {
      lineHeightValue.textContent = `${lineHeight.value}`;
      applyStyles();
    });
    textRotation.addEventListener('input', () => {
      textRotationValue.textContent = `${textRotation.value}°`;
      applyStyles();
    });
    textOpacity.addEventListener('input', () => {
      textOpacityValue.textContent = `${textOpacity.value}`;
      applyStyles();
    });
    borderWidth.addEventListener('input', () => {
      borderWidthValue.textContent = `${borderWidth.value}px`;
      applyStyles();
    });
    borderColor.addEventListener('input', applyStyles);
    shadowX.addEventListener('input', () => {
      shadowXValue.textContent = `${shadowX.value}px`;
      applyStyles();
    });
    shadowY.addEventListener('input', () => {
      shadowYValue.textContent = `${shadowY.value}px`;
      applyStyles();
    });
    glowThickness.addEventListener('input', () => {
      glowThicknessValue.textContent = `${glowThickness.value}px`;
      applyStyles();
    });
    glowColor.addEventListener('input', applyStyles);
    textAlignment.addEventListener('change', applyStyles);
    boldBtn.addEventListener('click', () => {
      boldBtn.classList.toggle('bg-blue-300');
      applyStyles();
    });
    italicBtn.addEventListener('click', () => {
      italicBtn.classList.toggle('bg-blue-300');
      applyStyles();
    });
    underlineBtn.addEventListener('click', () => {
      underlineBtn.classList.toggle('bg-blue-300');
      applyStyles();
    });

    // Download PNG
    downloadBtn.addEventListener('click', () => {
      const img = new Image();
      img.crossOrigin = 'Anonymous';
      img.src = cardImage.src;
      img.onload = () => {
        document.querySelectorAll('.resize-handle').forEach(h => h.style.display = 'none');
        document.querySelectorAll('.selected').forEach(el => el.classList.remove('selected'));
        html2canvas(cardMockup, {
          scale: 3,
          useCORS: true,
          backgroundColor: null
        }).then(canvas => {
          const link = document.createElement('a');
          link.download = 'business_card.png';
          link.href = canvas.toDataURL('image/png');
          link.click();
        });
      };
    });

    // Save settings
    saveSettingsBtn.addEventListener('click', () => {
      const settings = {
        background: cardImage.src,
        elements: []
      };
      document.querySelectorAll('.text-element, .logo, .social-element').forEach(el => {
        const elementData = {
          id: el.id,
          class: el.className,
          left: el.style.left,
          top: el.style.top,
          zIndex: el.style.zIndex
        };
        if (el.classList.contains('text-element')) {
          elementData.text = el.innerText;
          elementData.styles = {
            fontFamily: el.style.fontFamily,
            color: el.style.color,
            fontSize: el.style.fontSize,
            letterSpacing: el.style.letterSpacing,
            lineHeight: el.style.lineHeight,
            transform: el.style.transform,
            opacity: el.style.opacity,
            borderWidth: el.style.borderWidth,
            borderStyle: el.style.borderStyle,
            borderColor: el.style.borderColor,
            textShadow: el.style.textShadow,
            textAlign: el.style.textAlign,
            fontWeight: el.style.fontWeight,
            fontStyle: el.style.fontStyle,
            textDecoration: el.style.textDecoration
          };
        } else if (el.classList.contains('logo')) {
          elementData.src = el.src;
          elementData.maxWidth = el.style.maxWidth;
          elementData.maxHeight = el.style.maxHeight;
        } else if (el.classList.contains('social-element')) {
          elementData.iconSrc = el.querySelector('img').src;
          elementData.text = el.querySelector('.text-content').innerText;
          elementData.styles = {
            fontFamily: el.querySelector('.text-content').style.fontFamily,
            color: el.querySelector('.text-content').style.color,
            fontSize: el.querySelector('.text-content').style.fontSize,
            letterSpacing: el.querySelector('.text-content').style.letterSpacing,
            lineHeight: el.querySelector('.text-content').style.lineHeight,
            transform: el.style.transform,
            opacity: el.querySelector('.text-content').style.opacity,
            borderWidth: el.style.borderWidth,
            borderStyle: el.style.borderStyle,
            borderColor: el.style.borderColor,
            textShadow: el.querySelector('.text-content').style.textShadow,
            textAlign: el.querySelector('.text-content').style.textAlign,
            fontWeight: el.querySelector('.text-content').style.fontWeight,
            fontStyle: el.querySelector('.text-content').style.fontStyle,
            textDecoration: el.querySelector('.text-content').style.textDecoration
          };
        }
        settings.elements.push(elementData);
      });
      const blob = new Blob([JSON.stringify(settings)], { type: 'application/json' });
      const link = document.createElement('a');
      link.download = 'business_card_settings.json';
      link.href = URL.createObjectURL(blob);
      link.click();
    });

    // Upload settings
    uploadSettingsBtn.addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = () => {
          const settings = JSON.parse(reader.result);
          cardImage.src = settings.background;
          document.querySelectorAll('.text-element, .logo, .social-element, .resize-handle').forEach(el => el.remove());
          settings.elements.forEach(data => {
            if (data.class.includes('text-element')) {
              const textElement = document.createElement('div');
              textElement.className = 'text-element';
              textElement.id = data.id;
              textElement.innerText = data.text;
              Object.assign(textElement.style, {
                left: data.left,
                top: data.top,
                zIndex: data.zIndex,
                ...data.styles
              });
              const resizeHandle = document.createElement('div');
              resizeHandle.className = 'resize-handle';
              textElement.appendChild(resizeHandle);
              cardMockup.appendChild(textElement);
              makeDraggable(textElement);
              makeResizable(textElement, resizeHandle);
              addPinchResize(textElement);
              addSelection(textElement, resizeHandle);
            } else if (data.class.includes('logo')) {
              const logo = document.createElement('img');
              logo.className = 'logo';
              logo.id = data.id;
              logo.src = data.src;
              Object.assign(logo.style, {
                left: data.left,
                top: data.top,
                zIndex: data.zIndex,
                maxWidth: data.maxWidth,
                maxHeight: data.maxHeight
              });
              const resizeHandle = document.createElement('div');
              resizeHandle.className = 'resize-handle';
              cardMockup.appendChild(logo);
              cardMockup.appendChild(resizeHandle);
              makeDraggable(logo);
              makeResizable(logo, resizeHandle, true);
              addPinchResize(logo, true);
              addSelection(logo, resizeHandle);
            } else if (data.class.includes('social-element')) {
              const socialElement = document.createElement('div');
              socialElement.className = 'social-element';
              socialElement.id = data.id;
              socialElement.style.left = data.left;
              socialElement.style.top = data.top;
              socialElement.style.zIndex = data.zIndex;
              socialElement.style.display = 'flex';
              socialElement.style.alignItems = 'center';
              socialElement.style.gap = '8px';
              const img = document.createElement('img');
              img.src = data.iconSrc;
              img.style.width = '30px';
              img.style.height = '30px';
              const textNode = document.createElement('span');
              textNode.className = 'text-content';
              textNode.innerText = data.text;
              Object.assign(textNode.style, data.styles);
              socialElement.appendChild(img);
              socialElement.appendChild(textNode);
              const resizeHandle = document.createElement('div');
              resizeHandle.className = 'resize-handle';
              socialElement.appendChild(resizeHandle);
              cardMockup.appendChild(socialElement);
              makeDraggable(socialElement);
              makeResizable(socialElement, resizeHandle);
              addPinchResize(socialElement);
              addSelection(socialElement, resizeHandle);
            }
          });
        };
        reader.readAsText(file);
      }
    });

    // Deselect
    cardMockup.addEventListener('click', (e) => {
      if (e.target === cardMockup && currentSelected) {
        currentSelected.classList.remove('selected');
        if (currentSelected.handle) currentSelected.handle.style.display = 'none';
        textControls.classList.remove('active');
        currentSelected = null;
      }
    });
  </script>
</body>
</html>
```
