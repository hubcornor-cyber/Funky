<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Google Sheets Data Table</title>
  <style>
    table {
      border-collapse: collapse;
      width: 100%;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 1px;
      text-align: left;
      vertical-align: middle;
    }
    img {
      max-width: 100px;
      height: auto;
      display: block;
    }
  </style>
</head>
<body>
  <h1>Data Table</h1>
  <table id="dataTable">
    <thead></thead>
    <tbody></tbody>
  </table>

  <script>
    const sheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTEkZi9nWcRA2BtnTTAzOeJ9moxCQqZWZNqg3PAuV5KKIUXP7IRWg3oiE2A5TJH9_dY_LeG5MQH4z24/pub?gid=0&single=true&output=tsv';

    fetch(sheetUrl)
      .then(response => response.text())
      .then(data => {
        const rows = data.trim().split('\n').map(row => row.split('\t'));
        if (rows.length === 0) {
          document.getElementById('dataTable').textContent = 'No data found';
          return;
        }

        const thead = document.querySelector('#dataTable thead');
        const tbody = document.querySelector('#dataTable tbody');

        // Create header row dynamically from first row
        const headers = rows[0];
        const headerRow = document.createElement('tr');
        headers.forEach(h => {
          const th = document.createElement('th');
          th.textContent = h;
          headerRow.appendChild(th);
        });
        thead.appendChild(headerRow);
 
        // Now generate tbody rows using your template literal structure
        for (let i = 1; i < rows.length; i++) {
          const row = rows[i];

          // Use template literal with fixed columns and image in 5th column
          const trHtml = `
            <tr>
              <td>${row[0] || ''}</td>
              <td>${row[1] || ''}</td>
              <td>${row[2] || ''}</td>
              <td>${row[3] || ''}</td>
              <td>${row[4] || ''}</td>
              <td>${row[5] || ''}</td>
              <td>${row[6] || ''}</td>
              <td><img src="${row[7] || ''}" alt="Photo"></td>
            </tr>
          `;
          tbody.insertAdjacentHTML('beforeend', trHtml);
        }
      })
      .catch(error => {
        console.error('Error:', error);
        document.getElementById('dataTable').textContent = 'Failed to load data.';
      });
  </script>
</body>
</html>
